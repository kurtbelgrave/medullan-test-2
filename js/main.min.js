define("2048",[],function(){function r(n,r,i){this.nEmpty=e,this.targetMaxNum=r,this.newNumVal=i,this.grid=n,this.squares=[t,t,t,t,t,t,t,t,t,t,t,t,t,t,t,t]}var e=16,t=0,n={};return n.newBoard=function(e,t,n){return new r(e,t,n)},n.getMaxNSquares=function(){return e},r.prototype.getTargetMaxNum=function(){return this.targetMaxNum},r.prototype.getNewNumVal=function(){return this.newNumVal},r.prototype.reset=function(){var n;for(n=0;n<e;n++)this.squares[n]=t;this.nEmpty=e,this.spawnNewNumber(),this.spawnNewNumber()},r.prototype.spawnNewNumber=function(){var n,r;if(this.nEmpty===0)return;n=Math.random()*100%this.nEmpty,n=Math.floor(n);for(r=0;r<e;r++)this.squares[r]==t&&n--===0&&(this.squares[r]=this.newNumVal,this.nEmpty--)},r.prototype.collapseRow=function(e,n){var r,i,s=0,o;r=e;for(o=0;o<3;o++,r+=n){if(this.squares[r]==t)continue;i=r+n,this.squares[r]==this.squares[i]&&(this.squares[r]*=2,this.squares[i]=t,this.nEmpty++,s=1)}return s},r.prototype.collapseDown=function(){var e,t=0;for(e=12;e<16;e++)t+=this.collapseRow(e,-4);return t},r.prototype.collapseUp=function(){var e,t=0;for(e=0;e<4;e++)t+=this.collapseRow(e,4);return t},r.prototype.collapseRight=function(){var e,t=0;for(e=3;e<16;e+=4)t+=this.collapseRow(e,-1);return t},r.prototype.collapseLeft=function(){var e,t=0;for(e=0;e<16;e+=4)t+=this.collapseRow(e,1);return t},r.prototype.shiftRow=function(e,n){var r,i,s=0,o;r=e;for(o=0;o<3;o++,r+=n){if(this.squares[r]!=t)continue;i=r+n;if(this.squares[i]==t)continue;this.squares[r]=this.squares[i],this.squares[i]=t,s=1}return s},r.prototype.shiftDown=function(){var e,t=0;for(e=12;e<16;e++)while(this.shiftRow(e,-4))t++;return t},r.prototype.shiftUp=function(){var e,t=0;for(e=0;e<4;e++)while(this.shiftRow(e,4))t++;return t},r.prototype.shiftRight=function(){var e,t=0;for(e=3;e<16;e+=4)while(this.shiftRow(e,-1))t++;return t},r.prototype.shiftLeft=function(){var e,t=0;for(e=0;e<16;e+=4)while(this.shiftRow(e,1))t++;return t},r.prototype.draw=function(){function i(e){var n,r=[{num:2,colour:"grey"},{num:4,colour:"brown"},{num:8,colour:"teal"},{num:16,colour:"red"},{num:32,colour:"pink"},{num:64,colour:"purple"},{num:128,colour:"blue"},{num:256,colour:"green"},{num:512,colour:"white"},{num:1024,colour:"yellow"},{num:2048,colour:"gold"}];if(e==t)return"";for(n=0;n<r.length;n++)if(r[n].num==e)return r[n].colour;return""}var e,n,r;n=this.grid.getElementsByTagName("div");for(r=0,e=0;r<16;r++,e++)n[r].style.backgroundColor=i(this.squares[e]),n[r].innerHTML='<span class="cell-number">'+(this.squares[e]===0?"":this.squares[e])+"</span>"},r.prototype.moveDown=function(){var e,t;return e=this.shiftDown(),t=this.collapseDown(),e+=this.shiftDown(),(e||t)&&this.spawnNewNumber(),e+t},r.prototype.moveUp=function(){var e,t;return e=this.shiftUp(),t=this.collapseUp(),e+=this.shiftUp(),(e||t)&&this.spawnNewNumber(),e+t},r.prototype.moveLeft=function(){var e,t;return e=this.shiftLeft(),t=this.collapseLeft(),e+=this.shiftLeft(),(e||t)&&this.spawnNewNumber(),e+t},r.prototype.moveRight=function(){var e,t;return e=this.shiftRight(),t=this.collapseRight(),e+=this.shiftRight(),(e||t)&&this.spawnNewNumber(),e+t},n}),require(["2048"],function(e){function i(e){var n,r=0;n=window.event||e;switch(n.keyCode){case 37:r=t.moveLeft();break;case 38:r=t.moveUp();break;case 39:r=t.moveRight();break;case 40:r=t.moveDown()}r&&t.draw()}var t,n,r=!1;n=document.getElementById("div_2048_grid"),t=e.newBoard(n,2048,2),n.addEventListener("click",function(){r?(document.removeEventListener("keydown",i),r=!1):(document.addEventListener("keydown",i),r=!0,n.scrollIntoView(!0))}),document.getElementById("button_2048_reset").addEventListener("click",function(){t.reset(),t.draw(),n.scrollIntoView(!0)}),t.reset(),t.draw()}),define("main",function(){});